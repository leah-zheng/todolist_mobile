<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>todolist</title>
    <script src="lcXys.js"></script>
    <link rel="stylesheet" href="todolist.css">
</head>

<body>
    <div class="main">
        <div class="header">
            <div class="logo">ToDoList</div>
            <input type="text" placeholder="请输入todo" id="input">
        </div>
        <div class="doing todo">
            <h3><span class="title">正在进行中</span>
                <span class="num">0</span></h3>
            <div class="list ">
                <!-- <div class="todoitem">
                    <input type="checkbox" name="" id="">
                    <div class="content">做作业</div>
                    <div class="del">删除</div>
                </div> -->
            </div>
        </div>
        <div class="done todo">
            <h3><span class="title">已完成</span>
                <span class="num">0</span></h3>
            <div class="list">
                <!-- <div class="todoitem">
                    <input type="checkbox" name="" id="">
                    <div class="content">做作业</div>
                    <div class="del">删除</div>
                </div> -->
            </div>
        </div>
    </div>
    <script>
        // //存储代办事项
        if (localStorage.todolist == undefined) {
            var todolist = [];
        } else {
            var todolist = JSON.parse(localStorage.todolist);
        }


        var doinglist = document.querySelector('.doing .list')
        var donelist = document.querySelector('.done .list')
        var input = document.querySelector('#input');
        var main = document.querySelector('.main');
        var doingNum = document.querySelector('.doing .num');
        var doneNum = document.querySelector('.done .num');
        input.addEventListener("keydown", function(e) {
            if (event.key == "Enter") {
                console.log(e);
                var value = input.value;
                var objItem = {
                    content: value,
                    isDone: false
                }
                todolist.push(objItem);
                console.log(todolist);

                render(todolist)
            }
        })

        function render(todolist) {
            // 将数组对象转成json格式的字符串存储在本地的localstorage
            localStorage.todolist = JSON.stringify(todolist);
            doinglist.innerHTML = '';
            donelist.innerHTML = '';
            todolist.forEach(function(item, index) {

                var todoitem = document.createElement('div');
                todoitem.className = "todoitem";
                if (item.isDone) {
                    todoitem.innerHTML = `
						<input type="checkbox" checked="checked" data-index="${index}">
						<div class="content">` + item.content + `</div>
						<div class="del" data-index="${index}">删除</div>`
                    donelist.appendChild(todoitem)
                } else {
                    todoitem.innerHTML = `
						<input type="checkbox" data-index="${index}">
						<div class="content">` + item.content + `</div>
						<div class="del" data-index="${index}">删除</div>`
                    doinglist.appendChild(todoitem)

                }
                var doingnum = doinglist.childNodes.length;
                doingNum.innerHTML = doingnum;
                var donenum = donelist.childNodes.length;
                doneNum.innerHTML = donenum;


            })
        }
        render(todolist)

        doinglist.onchange = function(e) {
            //console.log(e)
            //通过事件对象找到dom对象,获取索引值


            var index = parseInt(e.target.dataset.index);
            console.log(e.target.dataset.index);
            todolist[index].isDone = true;
            console.log(e);
            console.log(doinglist);

            render(todolist)


        }
        donelist.onchange = function(e) {
            //console.log(e)
            //通过事件对象找到dom对象,获取索引值
            var index = parseInt(e.target.dataset.index);
            //console.log(index)
            todolist[index].isDone = false;
            render(todolist);

        }
        main.addEventListener("click", function(e) {
            if (e.target.className == "del") {
                var index = parseInt(e.target.dataset.index);
                todolist.splice(index, 1);
                render(todolist);
            }

        })
    </script>
</body>

</html>